<% provide :title, t(".title") %>

<h1><%= t ".title" %></h1>
<table class="table table-hover">
  <tr>
    <th><%= t ".product" %></th>
    <th><%= t ".price" %></th>
    <th><%= t ".quantity" %></th>
    <th><%= t ".update" %></th>
    <th><%= t ".delete" %></th>
  </tr>
  <% @cart.each do |cart| %>
    <tr>
      <td>
        <%= link_to cart.product.name, product_path(cart.product) %>
      </td>
      <%= form_for :cart, url: cart_path(cart), method: :patch do |f| %>
        <td>
          $<%= cart.product.price %> x
        </td>
        <td>
          <%= number_field_tag :quantity, cart.quantity, class: "form-control",
            min: 1, max: cart.product.quantity + cart.quantity %>
          <%= hidden_field_tag :cart_id, cart.id %>
        </td>
        <td>
          <%= f.button t(".update"), type: "submit", class: "btn btn-success" %>
        </td>
      <% end %>
      <td>
        <%= link_to t(".delete"), cart, method: :delete,
          data: {confirm: t(".confirmdelete")}, class: "btn btn-danger" %>
      </td>
    </tr>
  <% end %>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td><strong><%= t ".total" %></strong></td>
    <td><strong>$<%= @total_price %></strong></td>
  </tr>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td><%= link_to t(".history"), order_path(current_user) %></td>
    <% if @cart.any? %>
      <td>
        <%= link_to t(".purchased"), orders_path, method: :post,
          data: {confirm: t(".confirmpurchased")}, class: "btn btn-success" %>
      </td>
    <% end %>
  </tr>
</table>
